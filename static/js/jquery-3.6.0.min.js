$(document).ready(function() {
    // Display the selected file name and preview the image if it's an image
    $('#fileInput').change(function(event) {
        var file = event.target.files[0];
        var fileName = file ? file.name : 'No file chosen yet';
        $('#filePreview p').text(fileName);

        // Check if the selected file is an image and preview it
        if (file && file.type.startsWith('image/')) {
            var reader = new FileReader();
            reader.onload = function(e) {
                $('#filePreview').html('<img src="' + e.target.result + '" class="img-fluid" alt="Image Preview">');
            }
            reader.readAsDataURL(file);
        } else {
            $('#filePreview').html('<p>' + fileName + '</p>');
        }
    });

    // Validate form before submission (ensure a file is selected)
    $('#uploadForm').submit(function(event) {
        if (!$('#fileInput').val()) {
            event.preventDefault();
            alert('Please select a file to upload.');
        } else {
            // Show loader before form submission
            showLoader();
        }
    });

    // Loader functions
    function showLoader() {
        $("#loader-overlay").show();
    }

    function hideLoader() {
        $("#loader-overlay").hide();
    }

    $(window).on('load', function() {
        hideLoader();
    });

    $(window).on('unload', function() {
        hideLoader();
    });

    // Function to remove alert after 2 seconds
    function removeAlert() {
        setTimeout(function(){
            $(".alertBox").fadeOut(); // Use fadeOut for a smoother transition
        }, 2000); // Remove in 2 seconds
    }

    // For capital letter conversion
    function convertToUppercase(input) {
        input.value = input.value.toUpperCase();
    }

    // Loader image setup
    $("#loader-overlay").html("<img src='./static/images/loader.gif' alt='Loader'>");

    // Call removeAlert if needed, assuming you have alerts in your HTML
    removeAlert();
});
